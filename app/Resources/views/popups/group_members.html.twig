<div class="jscroll-inner" data-total="{{ members.totalCount }}">
{% for member in members %}
    <li class="user user-{{ member.user.id }}" data-user-id="{{ member.user.id }}">

        <div class="user-expand">
            {% if group.semiFormal and member.user.extraAttributes|length > 0 %}
                <a class="btn-circular toggle-extra-user-info" href="#"><span
                            class="fa fa-angle-double-down"></span></a>
            {% endif %}
        </div>

        {% if group.semiFormal %}
            <div class="user-avatar">
                {% if member.user.avatarUrl is not empty %}
                    <img class="thumbnail" src="{{ member.user.avatarUrl }}" />
                {% endif %}
            </div>
        {% endif %}

        <div class="user-name">
            <p>{{ member.user|display_name }}</p>
            <span>{{ member.user.emailAddress }}&nbsp;</span>

            {% if group.semiFormal %}
                <ul class="extra-attributes hidden">
                    {% for key, value in member.user.extraAttributes %}
                        <li>{{ render_extra_user_attribute(key, value) }}</li>
                    {% endfor %}
                </ul>
            {% endif %}

        </div>

        <div class="actions">

            {% if is_granted('EDIT', group) %}

                {% if member.role == 'prospect' %}

                    {% include ':popups:_prospect.html.twig' with {'user': member.user} %}

                {% else %}

                    <a href="#" class="delete rounded"
                       data-url="{{ path('membership_delete', {groupId: group.id, userId: member.user.id}) }}">
                        <i class="fa fa-minus"></i>
                    </a>

                    <select name="roles" class="roles"
                            data-url="{{ path('membership_update', {groupId: group.id, userId: member.user.id}) }}">
                        <option value="admin" {% if member.role == 'admin' %}selected{% endif %}>
                            {{ 'Admin'|trans }}
                        </option>
                        <option value="member" {% if member.role == 'member' %}selected{% endif %}>
                            {{ 'Member'|trans }}
                        </option>
                    </select>
                {% endif %}
            {% endif %}

        </div>
    </li>
{% endfor %}

{% set offset = offset + limit %}
{% if offset < members.totalCount %}
    <a class="groups-next" href="{{ path('search_group_members', {'id': group.id, 'query': query, 'offset': offset, 'limit': limit}) }}"></a>
{% endif %}
</div>
